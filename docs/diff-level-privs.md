# Использование модов

В больших системах, может быть недостаточно лишь режимов работы и разбиения переменных на различные файлы. Такими системами могут 
быть проекты основанные на различных типах IoC контейнеров. В зависимости от типа контейнера IoC необходимо подтягивать 
тот или иной файл соответствующий конкретному контейнеру, при чём делать это всё динамически.

>[!WARNING]
> Рекомендується создавать моды вне папки проекта, где-нибудь в другом месте компьютера или сервера.

## Уровни приватности

`EnvReader` устроен таким образом, что чтение файлов происходит цепочке и приоритету. При этом каждый из элементов цепочки 
является необязательным и тогда переменная будет взята из любого файлового элемента, если она одна. <br/> 

```mermaid
graph LR
    Local[Переменные JS / TS файлов]-->Mode1[Мод файл]-->Config[Файл конфигурации] 
    Mode2[Мод файл]-->Config[Файл конфигурации] 
```

Если одна и та же переменная будет в различных файлах, то будет записана та переменная, которая находится в файле с большим приоритетом.

>[!INFO]
> Разбивайте переменные, относящееся не к технологиям подключения, таким как порт, на котором работает сервер, а относящееся к проектным переменным, такие как 
> названия внешнего сервиса, паролей и других личных данных - хранить в модах.

> [!ATTENTION]
> Настоятельно не рекомендуется создавать приватные переменные внутри `JavaScript` / `TypeScript` файлов, поскольку: 
> 1. При попадании кода приложения третьему лицу, он будет в состоянии узнать данную, приватную переменную.
> 2. Усложняет создание манифестов (инструкций для выкладки приложения в `production`).
> 3. Служит потенциальным риском забыть / потерять конкретную переменную и тем самым её мутировать.

## Путь к модам

Чтобы `EnvReader` работал с модом, ему необходимо указать путь к нему. Этот путь указывается в зарезервированной переменной `ENV_MODE_[YOUR_MODE_NAME]` в файле `env.mode.json`. `EnvReader` также позволяет прописывать несколько модов в проекте. 

1. Пример файловой структуры
```
.
├── config
|   └── env.mode.json
├── src
|    └── index.js
├── package.json
```
2. Пример наполнения несколькими модами
```json
{
  "ENV_MODE_ERP": "/home/.env.erp",
  "ENV_MODE_TRS": "/home/.env.trs"
}
```

>[!INFO]
> Ключ `ENV_MODE` зарезервирован. Любая переменная которая начинается на `ENV_MODE_` будет восприниматься `EnvReader` как путь к моду. 
> Если путь к моду указан не корректно `EnvReader` выдаст соответствующую ошибку.

### Пример

1. Пример наполнения несколькими модами
```json
{
  "ERP_PORT": 4032,
  "ERP_HOST": "http"
}
```
